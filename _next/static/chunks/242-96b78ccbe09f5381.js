"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{7831:function(e,t,r){r.d(t,{i:function(){return a}});var n=r(7294),i=r(9251),o=r(4942);class s{constructor(e=Math){(0,o.Z)(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),(0,o.Z)(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),(0,o.Z)(this,"p",[]),(0,o.Z)(this,"perm",[]),(0,o.Z)(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),(0,o.Z)(this,"dot",((e,t,r)=>e[0]*t+e[1]*r)),(0,o.Z)(this,"dot3",((e,t,r,n)=>e[0]*t+e[1]*r+e[2]*n)),(0,o.Z)(this,"dot4",((e,t,r,n,i)=>e[0]*t+e[1]*r+e[2]*n+e[3]*i)),(0,o.Z)(this,"noise",((e,t)=>{let r,n,i;const o=(e+t)*(.5*(Math.sqrt(3)-1)),s=Math.floor(e+o),a=Math.floor(t+o),u=(3-Math.sqrt(3))/6,l=(s+a)*u,c=e-(s-l),p=t-(a-l);let m=0,h=1;c>p&&(m=1,h=0);const f=c-m+u,_=p-h+u,d=c-1+2*u,x=p-1+2*u,y=255&s,v=255&a,g=this.perm[y+this.perm[v]]%12,b=this.perm[y+m+this.perm[v+h]]%12,w=this.perm[y+1+this.perm[v+1]]%12;let M=.5-c*c-p*p;M<0?r=0:(M*=M,r=M*M*this.dot(this.grad3[g],c,p));let S=.5-f*f-_*_;S<0?n=0:(S*=S,n=S*S*this.dot(this.grad3[b],f,_));let T=.5-d*d-x*x;return T<0?i=0:(T*=T,i=T*T*this.dot(this.grad3[w],d,x)),70*(r+n+i)})),(0,o.Z)(this,"noise3d",((e,t,r)=>{let n,i,o,s;const a=(e+t+r)*(1/3),u=Math.floor(e+a),l=Math.floor(t+a),c=Math.floor(r+a),p=1/6,m=(u+l+c)*p,h=e-(u-m),f=t-(l-m),_=r-(c-m);let d,x,y,v,g,b;h>=f?f>=_?(d=1,x=0,y=0,v=1,g=1,b=0):h>=_?(d=1,x=0,y=0,v=1,g=0,b=1):(d=0,x=0,y=1,v=1,g=0,b=1):f<_?(d=0,x=0,y=1,v=0,g=1,b=1):h<_?(d=0,x=1,y=0,v=0,g=1,b=1):(d=0,x=1,y=0,v=1,g=1,b=0);const w=h-d+p,M=f-x+p,S=_-y+p,T=h-v+2*p,C=f-g+2*p,A=_-b+2*p,E=h-1+.5,k=f-1+.5,D=_-1+.5,B=255&u,P=255&l,R=255&c,V=this.perm[B+this.perm[P+this.perm[R]]]%12,L=this.perm[B+d+this.perm[P+x+this.perm[R+y]]]%12,I=this.perm[B+v+this.perm[P+g+this.perm[R+b]]]%12,j=this.perm[B+1+this.perm[P+1+this.perm[R+1]]]%12;let U=.6-h*h-f*f-_*_;U<0?n=0:(U*=U,n=U*U*this.dot3(this.grad3[V],h,f,_));let O=.6-w*w-M*M-S*S;O<0?i=0:(O*=O,i=O*O*this.dot3(this.grad3[L],w,M,S));let z=.6-T*T-C*C-A*A;z<0?o=0:(z*=z,o=z*z*this.dot3(this.grad3[I],T,C,A));let F=.6-E*E-k*k-D*D;return F<0?s=0:(F*=F,s=F*F*this.dot3(this.grad3[j],E,k,D)),32*(n+i+o+s)})),(0,o.Z)(this,"noise4d",((e,t,r,n)=>{const i=this.grad4,o=this.simplex,s=this.perm,a=(Math.sqrt(5)-1)/4,u=(5-Math.sqrt(5))/20;let l,c,p,m,h;const f=(e+t+r+n)*a,_=Math.floor(e+f),d=Math.floor(t+f),x=Math.floor(r+f),y=Math.floor(n+f),v=(_+d+x+y)*u,g=e-(_-v),b=t-(d-v),w=r-(x-v),M=n-(y-v),S=(g>b?32:0)+(g>w?16:0)+(b>w?8:0)+(g>M?4:0)+(b>M?2:0)+(w>M?1:0);let T,C,A,E,k,D,B,P,R,V,L,I;T=o[S][0]>=3?1:0,C=o[S][1]>=3?1:0,A=o[S][2]>=3?1:0,E=o[S][3]>=3?1:0,k=o[S][0]>=2?1:0,D=o[S][1]>=2?1:0,B=o[S][2]>=2?1:0,P=o[S][3]>=2?1:0,R=o[S][0]>=1?1:0,V=o[S][1]>=1?1:0,L=o[S][2]>=1?1:0,I=o[S][3]>=1?1:0;const j=g-T+u,U=b-C+u,O=w-A+u,z=M-E+u,F=g-k+2*u,N=b-D+2*u,G=w-B+2*u,W=M-P+2*u,q=g-R+3*u,H=b-V+3*u,Y=w-L+3*u,Z=M-I+3*u,Q=g-1+4*u,K=b-1+4*u,J=w-1+4*u,$=M-1+4*u,X=255&_,ee=255&d,te=255&x,re=255&y,ne=s[X+s[ee+s[te+s[re]]]]%32,ie=s[X+T+s[ee+C+s[te+A+s[re+E]]]]%32,oe=s[X+k+s[ee+D+s[te+B+s[re+P]]]]%32,se=s[X+R+s[ee+V+s[te+L+s[re+I]]]]%32,ae=s[X+1+s[ee+1+s[te+1+s[re+1]]]]%32;let ue=.6-g*g-b*b-w*w-M*M;ue<0?l=0:(ue*=ue,l=ue*ue*this.dot4(i[ne],g,b,w,M));let le=.6-j*j-U*U-O*O-z*z;le<0?c=0:(le*=le,c=le*le*this.dot4(i[ie],j,U,O,z));let ce=.6-F*F-N*N-G*G-W*W;ce<0?p=0:(ce*=ce,p=ce*ce*this.dot4(i[oe],F,N,G,W));let pe=.6-q*q-H*H-Y*Y-Z*Z;pe<0?m=0:(pe*=pe,m=pe*pe*this.dot4(i[se],q,H,Y,Z));let me=.6-Q*Q-K*K-J*J-$*$;return me<0?h=0:(me*=me,h=me*me*this.dot4(i[ae],Q,K,J,$)),27*(l+c+p+m+h)}));for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());for(let t=0;t<512;t++)this.perm[t]=this.p[255&t]}}const a=n.forwardRef((({intensity:e=1,decay:t,decayRate:r=.65,maxYaw:o=.1,maxPitch:a=.1,maxRoll:u=.1,yawFrequency:l=.1,pitchFrequency:c=.1,rollFrequency:p=.1,controls:m},h)=>{const f=(0,i.Ky)((e=>e.camera)),_=(0,i.Ky)((e=>e.controls)),d=n.useRef(e),x=n.useRef(f.rotation.clone()),[y]=n.useState((()=>new s)),[v]=n.useState((()=>new s)),[g]=n.useState((()=>new s)),b=()=>{(d.current<0||d.current>1)&&(d.current=d.current<0?0:1)};return n.useImperativeHandle(h,(()=>({getIntensity:()=>d.current,setIntensity:e=>{d.current=e,b()}})),[]),n.useEffect((()=>{const e=_||(null==m?void 0:m.current),t=()=>{x.current=f.rotation.clone()};return null==e||e.addEventListener("change",t),()=>{null==e||e.removeEventListener("change",t)}}),[m,_]),(0,i.xQ)((({clock:e},n)=>{const i=Math.pow(d.current,2),s=o*i*y.noise(e.elapsedTime*l,1),m=a*i*v.noise(e.elapsedTime*c,1),h=u*i*g.noise(e.elapsedTime*p,1);f.rotation.set(x.current.x+m,x.current.y+s,x.current.z+h),t&&d.current>0&&(d.current-=r*n,b())})),null}))},6935:function(e,t,r){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}r.d(t,{r:function(){return l}});var i=r(7294),o=r(2212),s=r(9251),a=r(5878);class u extends o.MeshStandardMaterial{constructor(e={}){super(e),this._debug={value:0},this._tDepth={value:null},this._distortionMap={value:null},this._tDiffuse={value:null},this._u_mipmap_0={value:null},this._u_mipmap_1={value:null},this._u_mipmap_2={value:null},this._u_mipmap_3={value:null},this._u_mipmap_4={value:null},this._u_mipmap_5={value:null},this._u_mipmap_6={value:null},this._u_mipmap_7={value:null},this._u_mipmap_res_0={value:null},this._u_mipmap_res_1={value:null},this._u_mipmap_res_2={value:null},this._u_mipmap_res_3={value:null},this._u_mipmap_res_4={value:null},this._u_mipmap_res_5={value:null},this._u_mipmap_res_6={value:null},this._u_mipmap_res_7={value:null},this._textureMatrix={value:null},this._mirror={value:0},this._mixBlur={value:0},this._blurStrength={value:.5},this._minDepthThreshold={value:.9},this._maxDepthThreshold={value:1},this._depthScale={value:0},this._depthToBlurRatioBias={value:.25},this._distortion={value:1},this.setValues(e)}onBeforeCompile(e){var t;null!=(t=e.defines)&&t.USE_UV||(e.defines.USE_UV=""),e.uniforms.debug=this._debug,e.uniforms.tDiffuse=this._tDiffuse,e.uniforms.tDepth=this._tDepth,e.uniforms.distortionMap=this._distortionMap,e.uniforms.u_mipmap_0=this._u_mipmap_0,e.uniforms.u_mipmap_1=this._u_mipmap_1,e.uniforms.u_mipmap_2=this._u_mipmap_2,e.uniforms.u_mipmap_3=this._u_mipmap_3,e.uniforms.u_mipmap_4=this._u_mipmap_4,e.uniforms.u_mipmap_5=this._u_mipmap_5,e.uniforms.u_mipmap_6=this._u_mipmap_6,e.uniforms.u_mipmap_7=this._u_mipmap_7,e.uniforms.u_mipmap_res_0=this._u_mipmap_res_0,e.uniforms.u_mipmap_res_1=this._u_mipmap_res_1,e.uniforms.u_mipmap_res_2=this._u_mipmap_res_2,e.uniforms.u_mipmap_res_3=this._u_mipmap_res_3,e.uniforms.u_mipmap_res_4=this._u_mipmap_res_4,e.uniforms.u_mipmap_res_5=this._u_mipmap_res_5,e.uniforms.u_mipmap_res_6=this._u_mipmap_res_6,e.uniforms.u_mipmap_res_7=this._u_mipmap_res_7,e.uniforms.textureMatrix=this._textureMatrix,e.uniforms.mirror=this._mirror,e.uniforms.mixBlur=this._mixBlur,e.uniforms.mixStrength=this._blurStrength,e.uniforms.minDepthThreshold=this._minDepthThreshold,e.uniforms.maxDepthThreshold=this._maxDepthThreshold,e.uniforms.depthScale=this._depthScale,e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,e.uniforms.distortion=this._distortion,e.vertexShader=`\n        uniform mat4 textureMatrix;\n        varying vec4 my_vUv;     \n      ${e.vertexShader}`,e.vertexShader=e.vertexShader.replace("#include <project_vertex>","#include <project_vertex>\n        my_vUv = textureMatrix * vec4( position, 1.0 );\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );"),e.fragmentShader=`\n        uniform int debug;\n        uniform sampler2D tDiffuse;\n        uniform sampler2D tDepth;\n        uniform sampler2D distortionMap;\n        uniform sampler2D u_mipmap_0;\n        uniform sampler2D u_mipmap_1;\n        uniform sampler2D u_mipmap_2;\n        uniform sampler2D u_mipmap_3;\n        uniform sampler2D u_mipmap_4;\n        uniform sampler2D u_mipmap_5;\n        uniform sampler2D u_mipmap_6;\n        uniform sampler2D u_mipmap_7;\n        uniform vec2 u_mipmap_res_0;\n        uniform vec2 u_mipmap_res_1;\n        uniform vec2 u_mipmap_res_2;\n        uniform vec2 u_mipmap_res_3;\n        uniform vec2 u_mipmap_res_4;\n        uniform vec2 u_mipmap_res_5;\n        uniform vec2 u_mipmap_res_6;\n        uniform vec2 u_mipmap_res_7;\n        uniform float distortion;\n        uniform float cameraNear;\n\t\t\t  uniform float cameraFar;\n        uniform float mixBlur;\n        uniform float mirror;\n        uniform float mixStrength;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec4 my_vUv;  \n        \n        // from http://www.java-gaming.org/index.php?topic=35123.0\n        vec4 cubic( float v ) {\n          vec4 n = vec4( 1.0, 2.0, 3.0, 4.0 ) - v;\n          vec4 s = n * n * n;\n          float x = s.x;\n          float y = s.y - 4.0 * s.x;\n          float z = s.z - 4.0 * s.y + 6.0 * s.x;\n          float w = 6.0 - x - y - z;\n          return vec4( x, y, z, w ) * ( 1.0 / 6.0 );\n        }\n        \n        vec4 textureBicubic( sampler2D sampler, vec2 texCoords, vec2 texSize ) {\n          vec2 invTexSize = 1.0 / texSize;\n          texCoords = texCoords * texSize - 0.5;\n          vec2 fxy = fract( texCoords );\n          texCoords -= fxy;\n\n          vec4 xcubic = cubic( fxy.x );\n          vec4 ycubic = cubic( fxy.y );\n          vec4 c = texCoords.xxyy + vec2 ( - 0.5, + 1.5 ).xyxy;\n          vec4 s = vec4( xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw );\n\n          vec4 offset = c + vec4( xcubic.yw, ycubic.yw ) / s;\n          offset *= invTexSize.xxyy;\n        \n          vec4 sample0 = texture2D( sampler, offset.xz);\n          vec4 sample1 = texture2D( sampler, offset.yz);\n          vec4 sample2 = texture2D( sampler, offset.xw);\n          vec4 sample3 = texture2D( sampler, offset.yw);\n        \n          float sx = s.x / ( s.x + s.y );\n          float sy = s.z / ( s.z + s.w );\n\n          return mix(\n            mix(\n              sample3,\n              sample2,\n              sx\n            ),\n            mix(\n              sample1,\n              sample0,\n              sx\n            ),\n            sy\n          );\n        }\n\n\n        ${e.fragmentShader}`,e.fragmentShader=e.fragmentShader.replace("#include <emissivemap_fragment>","#include <emissivemap_fragment>\n    \n      float depthFactor = 1.0;\n      float distortionFactor = 0.0;\n      vec3 my_normal = vec3(0.0);\n      float reflectorRoughnessFactor = roughness;\n      vec3 coord = my_vUv.xyz / my_vUv.w;\n\n      #ifdef USE_DISTORTION\n        distortionFactor = texture2D(distortionMap, vUv).r * distortion;\n      #endif\n\n      #ifdef USE_NORMALMAP\n        vec4 normalColor = texture2D(normalMap, vUv * normalScale);\n        my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b ,  normalColor.g * 2.0 - 1.0 ) );\n      #endif\n\n      #ifdef USE_ROUGHNESSMAP\n        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );\n        reflectorRoughnessFactor *= reflectorTexelRoughness.g;\n      #endif\n\n      vec2 proj_vUv = coord.xy + coord.z * my_normal.xz * 0.01;\n      proj_vUv.x += distortionFactor;\n      proj_vUv.y += distortionFactor;\n      \n      float lod = 1.0 - min(1.0, mixBlur * reflectorRoughnessFactor);\n\n      #ifdef USE_DEPTH\n        vec4 depth = texture2D(tDepth, proj_vUv);\n        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n        depthFactor *= depthScale;\n        depthFactor = max(0.0001, min(1.0, depthFactor + depthToBlurRatioBias));\n      #endif\n\n      vec4 baseColor = texture2D(tDiffuse, proj_vUv);\n      vec4 mixedColor;\n\n      float _lod = (1.0 - pow(1.0 - lod, 4.0)) * 8.0;\n      if (_lod < 1.) {\n        vec4 one = textureBicubic(u_mipmap_7, proj_vUv, u_mipmap_res_7);\n        vec4 two = textureBicubic(u_mipmap_6, proj_vUv, u_mipmap_res_6);\n        mixedColor = mix(one, two, _lod);\n      } else if (_lod < 2.) {\n        vec4 one = textureBicubic(u_mipmap_6, proj_vUv, u_mipmap_res_6);\n        vec4 two = textureBicubic(u_mipmap_5, proj_vUv, u_mipmap_res_5);\n        mixedColor = mix(one, two, _lod - 1.0);\n      } else if (_lod < 3.) {\n        vec4 one = textureBicubic(u_mipmap_5, proj_vUv, u_mipmap_res_5);\n        vec4 two = textureBicubic(u_mipmap_4, proj_vUv, u_mipmap_res_4);\n        mixedColor = mix(one, two, _lod - 2.0);\n      } else if (_lod < 4.) {\n        vec4 one = textureBicubic(u_mipmap_4, proj_vUv, u_mipmap_res_4);\n        vec4 two = textureBicubic(u_mipmap_3, proj_vUv, u_mipmap_res_3);\n        mixedColor = mix(one, two, _lod - 3.0);\n      } else if (_lod < 5.) {\n        vec4 one = textureBicubic(u_mipmap_3, proj_vUv, u_mipmap_res_3);\n        vec4 two = textureBicubic(u_mipmap_2, proj_vUv, u_mipmap_res_2);\n        mixedColor = mix(one, two, _lod - 4.0);\n      } else if (_lod < 6.) {\n        vec4 one = textureBicubic(u_mipmap_2, proj_vUv, u_mipmap_res_2);\n        vec4 two = textureBicubic(u_mipmap_1, proj_vUv, u_mipmap_res_1);\n        mixedColor = mix(one, two, _lod - 5.0);\n      } else if (_lod < 7.) {\n        vec4 one = textureBicubic(u_mipmap_1, proj_vUv, u_mipmap_res_1);\n        vec4 two = textureBicubic(u_mipmap_0, proj_vUv, u_mipmap_res_0);\n        mixedColor = mix(one, two, _lod - 6.0);\n      } else {\n        vec4 one = textureBicubic(u_mipmap_0, proj_vUv, u_mipmap_res_0);\n        mixedColor = mix(one, baseColor, _lod - 7.0);\n      }\n\n      mixedColor.rgb *= depthFactor;\n      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + mixedColor.rgb * mixStrength);     \n      diffuseColor = sRGBToLinear(diffuseColor);\n\n      if (debug == 1) {\n        diffuseColor = sRGBToLinear(vec4(vec3(depthFactor), 1.0));\n      }\n      if (debug == 2) {\n        diffuseColor = sRGBToLinear(texture2D(tDiffuse, proj_vUv));\n      }\n      if (debug == 3) {\n        diffuseColor = sRGBToLinear(texture2D(distortionMap, vUv));\n      }\n      if (debug == 4) {\n        diffuseColor = sRGBToLinear(vec4(vec3(lod), 1.0));\n      }\n      ")}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(e){this._tDiffuse.value=e}get tDepth(){return this._tDepth.value}set tDepth(e){this._tDepth.value=e}get distortionMap(){return this._distortionMap.value}set distortionMap(e){this._distortionMap.value=e}get u_mipmap_0(){return this._u_mipmap_0.value}set u_mipmap_0(e){this._u_mipmap_0.value=e}get u_mipmap_1(){return this._u_mipmap_1.value}set u_mipmap_1(e){this._u_mipmap_1.value=e}get u_mipmap_2(){return this._u_mipmap_2.value}set u_mipmap_2(e){this._u_mipmap_2.value=e}get u_mipmap_3(){return this._u_mipmap_3.value}set u_mipmap_3(e){this._u_mipmap_3.value=e}get u_mipmap_4(){return this._u_mipmap_4.value}set u_mipmap_4(e){this._u_mipmap_4.value=e}get u_mipmap_5(){return this._u_mipmap_5.value}set u_mipmap_5(e){this._u_mipmap_5.value=e}get u_mipmap_6(){return this._u_mipmap_6.value}set u_mipmap_6(e){this._u_mipmap_6.value=e}get u_mipmap_7(){return this._u_mipmap_7.value}set u_mipmap_7(e){this._u_mipmap_7.value=e}get u_mipmap_res_0(){return this._u_mipmap_res_0.value}set u_mipmap_res_0(e){this._u_mipmap_res_0.value=e}get u_mipmap_res_1(){return this._u_mipmap_res_1.value}set u_mipmap_res_1(e){this._u_mipmap_res_1.value=e}get u_mipmap_res_2(){return this._u_mipmap_res_2.value}set u_mipmap_res_2(e){this._u_mipmap_res_2.value=e}get u_mipmap_res_3(){return this._u_mipmap_res_3.value}set u_mipmap_res_3(e){this._u_mipmap_res_3.value=e}get u_mipmap_res_4(){return this._u_mipmap_res_4.value}set u_mipmap_res_4(e){this._u_mipmap_res_4.value=e}get u_mipmap_res_5(){return this._u_mipmap_res_5.value}set u_mipmap_res_5(e){this._u_mipmap_res_5.value=e}get u_mipmap_res_6(){return this._u_mipmap_res_6.value}set u_mipmap_res_6(e){this._u_mipmap_res_6.value=e}get u_mipmap_res_7(){return this._u_mipmap_res_7.value}set u_mipmap_res_7(e){this._u_mipmap_res_7.value=e}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(e){this._textureMatrix.value=e}get mirror(){return this._mirror.value}set mirror(e){this._mirror.value=e}get mixBlur(){return this._mixBlur.value}set mixBlur(e){this._mixBlur.value=e}get mixStrength(){return this._blurStrength.value}set mixStrength(e){this._blurStrength.value=e}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(e){this._minDepthThreshold.value=e}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(e){this._maxDepthThreshold.value=e}get depthScale(){return this._depthScale.value}set depthScale(e){this._depthScale.value=e}get debug(){return this._debug.value}set debug(e){this._debug.value=e}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(e){this._depthToBlurRatioBias.value=e}get distortion(){return this._distortion.value}set distortion(e){this._distortion.value=e}}(0,s.l7)({MeshReflectorMaterial:u});const l=i.forwardRef((({mixBlur:e=0,mixStrength:t=.5,resolution:r=256,args:u=[1,1],minDepthThreshold:l=.9,maxDepthThreshold:c=1,depthScale:p=0,depthToBlurRatioBias:m=.25,mirror:h,children:f,debug:_=0,distortion:d=1,distortionMap:x,...y},v)=>{const g=(0,s.Ky)((({gl:e})=>e)),b=(0,s.Ky)((({camera:e})=>e)),w=(0,s.Ky)((({scene:e})=>e)),M=i.useRef(null),[S]=i.useState((()=>new o.Plane)),[T]=i.useState((()=>new o.Vector3)),[C]=i.useState((()=>new o.Vector3)),[A]=i.useState((()=>new o.Vector3)),[E]=i.useState((()=>new o.Matrix4)),[k]=i.useState((()=>new o.Vector3(0,0,-1))),[D]=i.useState((()=>new o.Vector4)),[B]=i.useState((()=>new o.Vector3)),[P]=i.useState((()=>new o.Vector3)),[R]=i.useState((()=>new o.Vector4)),[V]=i.useState((()=>new o.Matrix4)),[L]=i.useState((()=>new o.PerspectiveCamera)),[I]=i.useState((()=>{const e=[],t={minFilter:o.LinearFilter,magFilter:o.LinearFilter,format:o.RGBFormat,encoding:g.outputEncoding};for(let n=0;n<8;n++){const i=Math.max(8,Math.round(r/Math.pow(2,n))),s=new o.WebGLRenderTarget(i,i,t);s.texture.generateMipmaps=!1,e.push(s)}return e})),j=i.useCallback((()=>{if(C.setFromMatrixPosition(M.current.matrixWorld),A.setFromMatrixPosition(b.matrixWorld),E.extractRotation(M.current.matrixWorld),T.set(0,0,1),T.applyMatrix4(E),B.subVectors(C,A),B.dot(T)>0)return;B.reflect(T).negate(),B.add(C),E.extractRotation(b.matrixWorld),k.set(0,0,-1),k.applyMatrix4(E),k.add(A),P.subVectors(C,k),P.reflect(T).negate(),P.add(C),L.position.copy(B),L.up.set(0,1,0),L.up.applyMatrix4(E),L.up.reflect(T),L.lookAt(P),L.far=b.far,L.updateMatrixWorld(),L.projectionMatrix.copy(b.projectionMatrix),V.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),V.multiply(L.projectionMatrix),V.multiply(L.matrixWorldInverse),V.multiply(M.current.matrixWorld),S.setFromNormalAndCoplanarPoint(T,C),S.applyMatrix4(L.matrixWorldInverse),D.set(S.normal.x,S.normal.y,S.normal.z,S.constant);const e=L.projectionMatrix;R.x=(Math.sign(D.x)+e.elements[8])/e.elements[0],R.y=(Math.sign(D.y)+e.elements[9])/e.elements[5],R.z=-1,R.w=(1+e.elements[10])/e.elements[14],D.multiplyScalar(2/D.dot(R)),e.elements[2]=D.x,e.elements[6]=D.y,e.elements[10]=D.z+1,e.elements[14]=D.w}),[b.far,b.matrixWorld,b.projectionMatrix,A,D,k,T,R,S,C,E,P,V,B,L]),[U,O]=i.useMemo((()=>{const n={minFilter:o.LinearFilter,magFilter:o.LinearFilter,format:o.RGBFormat,encoding:g.outputEncoding},i=new o.WebGLRenderTarget(r,r,n);p>0&&(i.depthBuffer=!0,i.depthTexture=new o.DepthTexture(r,r),i.depthTexture.format=o.DepthFormat,i.depthTexture.type=o.UnsignedShortType);const s=I.reduce(((e,t,r)=>(e[`u_mipmap_${r}`]=t.texture,e[`u_mipmap_res_${r}`]=new o.Vector2(t.width,t.height),e)),{});return[i,{mirror:h,textureMatrix:V,mixBlur:e,tDiffuse:i.texture,tDepth:i.depthTexture,mixStrength:t,minDepthThreshold:l,maxDepthThreshold:c,depthScale:p,depthToBlurRatioBias:m,debug:_,distortion:d,distortionMap:x,"defines-USE_DEPTH":p>0?"":void 0,"defines-USE_DISTORTION":x?"":void 0,...s}]}),[g,V,r,h,e,t,l,c,p,m,_,d,x,I]);return(0,s.xQ)((()=>{if(null==M||!M.current)return;M.current.visible=!1;const t=g.xr.enabled,r=g.shadowMap.autoUpdate;j(),g.xr.enabled=!1,g.shadowMap.autoUpdate=!1,g.setRenderTarget(U),g.state.buffers.depth.setMask(!0),g.autoClear||g.clear(),g.render(w,L),0!==e&&I.forEach((e=>{g.setRenderTarget(e),g.state.buffers.depth.setMask(!0),g.render(w,L)})),g.xr.enabled=t,g.shadowMap.autoUpdate=r,M.current.visible=!0,g.setRenderTarget(null)})),i.createElement("mesh",n({ref:(0,a.Z)([M,v])},y),i.createElement("planeBufferGeometry",{args:u}),f?f("meshReflectorMaterial",O):i.createElement("meshReflectorMaterial",O))}))},5769:function(e,t,r){r.d(t,{m:function(){return a}});var n=r(2212),i=r(9251),o=r(7294);const s=e=>e===Object(e)&&!Array.isArray(e)&&"function"!==typeof e;function a(e){const t=(0,i.Ky)((e=>e.gl)),r=(0,i.U2)(n.TextureLoader,s(e)?Object.values(e):e);if((0,o.useEffect)((()=>{(Array.isArray(r)?r:[r]).forEach(t.initTexture)}),[t,r]),s(e)){const t=Object.keys(e),n={};return t.forEach((e=>Object.assign(n,{[e]:r[t.indexOf(e)]}))),n}return r}a.preload=e=>i.U2.preload(n.TextureLoader,e),a.clear=e=>i.U2.clear(n.TextureLoader,e)},3277:function(e,t,r){r.d(t,{dp:function(){return c},xC:function(){return m}});var n=r(5845),i=r(7294),o=r(2212),s=r(9251);const a=(e,t=n.YQ.NORMAL)=>(0,i.forwardRef)((function({blendFunction:r,opacity:n,...o},s){const a=(0,i.useMemo)((()=>new e(o)),[o]);return(0,i.useLayoutEffect)((()=>{a.blendMode.blendFunction=r||t,void 0!==n&&(a.blendMode.opacity.value=n)}),[r,a.blendMode,n]),i.createElement("primitive",{ref:s,object:a,dispose:null})})),u=(e,t)=>{const r=e[t];return(0,i.useMemo)((()=>{if(r instanceof o.Vector2)return(new o.Vector2).set(r.x,r.y);if(Array.isArray(r)){const[e,t]=r;return(new o.Vector2).set(e,t)}}),[r])},l=()=>{try{const e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}},c=a(n.rk,n.YQ.SCREEN),p=(a(n.at),(0,i.forwardRef)((function(e,t){const r=u(e,"offset"),o=(0,i.useMemo)((()=>new n.YY({...e,offset:r})),[r,e]);return i.createElement("primitive",{ref:t,object:o,dispose:null})})),(0,i.forwardRef)((function({blendFunction:e=n.YQ.NORMAL},t){const r=(0,i.useMemo)((()=>new n.TC(e)),[e]);return i.createElement("primitive",{ref:t,object:r,dispose:null})})),a(n.zo),a(n.AL),(0,i.createContext)(null)),m=i.memo((0,i.forwardRef)((({children:e,camera:t,scene:r,renderPriority:o=1,autoClear:a=!0,depthBuffer:u,disableNormalPass:c,stencilBuffer:m,multisampling:h=8,frameBufferType:f},_)=>{const{gl:d,scene:x,camera:y,size:v}=(0,s.Ky)();r=r||x,t=t||y;const[g,b]=(0,i.useMemo)((()=>{const e=new n.xC(d,{depthBuffer:u,stencilBuffer:m,multisampling:l()?h:0,frameBufferType:f});e.addPass(new n.CD(r,t));const i=c?null:new n.gh(r,t);return i&&e.addPass(i),[e,i]}),[t,d,u,m,h,f,r,c]);(0,i.useEffect)((()=>null==g?void 0:g.setSize(v.width,v.height)),[g,v]),(0,s.xQ)(((e,t)=>(d.autoClear=a,void g.render(t))),o);const w=(0,i.useRef)(null);(0,i.useEffect)((()=>{let e;return w.current&&w.current.__r3f&&g&&(e=new n.H5(t,...w.current.__r3f.objects),g.addPass(e),e.renderToScreen=!0),()=>{e&&(null==g||g.removePass(e))}}),[g,e,t]);const M=(0,i.useMemo)((()=>({composer:g,normalPass:b,camera:t,scene:r})),[g,b,t,r]);return(0,i.useImperativeHandle)(_,(()=>g),[g]),i.createElement(p.Provider,{value:M},i.createElement("group",{ref:w},e))})));(0,i.forwardRef)((function({target:e,depthTexture:t,...r},s){const{camera:a}=(0,i.useContext)(p),u=(0,i.useMemo)((()=>new n.Jy(a,r)),[a,r]);return(0,i.useLayoutEffect)((()=>{if(e){const t=e instanceof o.Vector3?(new o.Vector3).set(e.x,e.y,e.z):(new o.Vector3).set(e[0],e[1],e[2]);u.target=t}t&&u.setDepthTexture(t.texture,t.packing)}),[e,t,u]),i.createElement("primitive",{ref:s,object:u,dispose:null})})),a(n.ol),(0,i.forwardRef)((function({active:e=!0,...t},r){const o=u(t,"delay"),s=u(t,"duration"),a=u(t,"strength"),l=(0,i.useMemo)((()=>new n.sy({...t,delay:o,duration:s,strength:a})),[o,s,t,a]);return(0,i.useLayoutEffect)((()=>{l.mode=e?t.mode||n.O7.SPORADIC:n.O7.DISABLED}),[e,l,t.mode]),i.createElement("primitive",{ref:r,object:l,dispose:null})})),(0,i.forwardRef)((function(e,t){const{camera:r}=(0,i.useContext)(p),o=(0,i.useMemo)((()=>new n.KI(r,e.sun,e)),[r,e]);return i.createElement("primitive",{ref:t,object:o,dispose:null})})),(0,i.forwardRef)((function({size:e,...t},r){const o=(0,i.useMemo)((()=>new n.Qt(t)),[t]);return(0,i.useLayoutEffect)((()=>{e&&o.setSize(e.width,e.height)}),[o,e]),i.createElement("primitive",{ref:r,object:o,dispose:null})})),a(n.JL),a(n.xV,n.YQ.COLOR_DODGE),(0,i.forwardRef)((function({selection:e=[],selectionLayer:t=10,blendFunction:r,patternTexture:o,edgeStrength:s,pulseSpeed:a,visibleEdgeColor:u,hiddenEdgeColor:l,width:c,height:m,kernelSize:h,blur:f,xRay:_,...d},x){const{scene:y,camera:v}=(0,i.useContext)(p),g=(0,i.useMemo)((()=>new n.Mn(y,v,{blendFunction:r,patternTexture:o,edgeStrength:s,pulseSpeed:a,visibleEdgeColor:u,hiddenEdgeColor:l,width:c,height:m,kernelSize:h,blur:f,xRay:_})),[r,f,v,s,m,l,h,o,a,y,u,c,_]);return(0,i.useEffect)((()=>{g.clearSelection(),g.setSelection(Array.isArray(e)?e.map((e=>e.current)):[e.current])}),[g,e]),(0,i.useEffect)((()=>{g.selectionLayer=t}),[g,t]),i.createElement("primitive",{ref:x,object:g,dispose:null})})),(0,i.forwardRef)((function({granularity:e=5},t){const r=(0,i.useMemo)((()=>new n.Qg(e)),[e]);return i.createElement("primitive",{ref:t,object:r,dispose:null})})),a(n.p$,n.YQ.OVERLAY),(0,i.forwardRef)((function({selection:e=[],selectionLayer:t=10,lights:r=[],luminanceThreshold:o,luminanceSmoothing:s,intensity:a,width:u,height:l,kernelSize:c},m){0===r.length&&console.warn("SelectiveBloom requires lights to work.");const{scene:h,camera:f}=(0,i.useContext)(p),_=(0,i.useMemo)((()=>new n.V$(h,f,{blendFunction:n.YQ.SCREEN,luminanceThreshold:o,luminanceSmoothing:s,intensity:a,width:u,height:l,kernelSize:c})),[f,l,a,c,s,o,h,u]);return(0,i.useEffect)((()=>{_.selection.set(Array.isArray(e)?e.map((e=>e.current)):[e.current])}),[_,e]),(0,i.useEffect)((()=>{_.selection.layer=t}),[_,t]),(0,i.useEffect)((()=>(r.forEach((e=>((e,t)=>{e.current&&e.current.layers.enable(t.selection.layer)})(e,_))),()=>r.forEach((e=>((e,t)=>{e.current&&e.current.layers.disable(t.selection.layer)})(e,_))))),[_,r,t]),i.createElement("primitive",{ref:m,object:_,dispose:null})})),a(n.wL),(0,i.forwardRef)((function(e,t){const{camera:r,normalPass:o}=(0,i.useContext)(p),s=(0,i.useMemo)((()=>null===o?(console.error("Please enable the NormalPass in the EffectComposer in order to use SSAO."),null):new n.bn(r,o.renderTarget.texture,{blendFunction:n.YQ.MULTIPLY,samples:30,rings:4,distanceThreshold:1,distanceFalloff:0,rangeThreshold:.5,rangeFalloff:.1,luminanceInfluence:.9,radius:20,scale:.5,bias:.5,...e})),[r,o,e]);return i.createElement("primitive",{ref:t,object:s,dispose:null})})),(0,i.forwardRef)((function({preset:e=n.F9.HIGH,edgeDetectionMode:t=n.HN.COLOR},r){const o=(0,s.U2)(n.hB,""),a=(0,i.useMemo)((()=>new n.fY(...o,e,t)),[o,e,t]);return i.createElement("primitive",{ref:r,object:a,dispose:null})})),(0,i.forwardRef)((function({textureSrc:e,texture:t,...r},a){const u=(0,s.U2)(o.TextureLoader,e);(0,i.useLayoutEffect)((()=>{u.encoding=o.sRGBEncoding,u.wrapS=u.wrapT=o.RepeatWrapping}),[u]);const l=(0,i.useMemo)((()=>new n.tq({...r,texture:u||t})),[r,u,t]);return i.createElement("primitive",{ref:a,object:l,dispose:null})})),a(n.M4),a(n.Dd),a(n.Uy),(0,i.forwardRef)((function({lut:e,tetrahedralInterpolation:t,...r},o){const s=(0,i.useMemo)((()=>new n.YH(e,r)),[e,r]);return(0,i.useLayoutEffect)((()=>{e&&s.setLUT(e),t&&s.setTetrahedralInterpolationEnabled(t)}),[s,e,t]),i.createElement("primitive",{ref:o,object:s,dispose:null})}))},91:function(e,t,r){function n(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}r.d(t,{Z:function(){return n}})},7625:function(e,t,r){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(u){a=!0,i=u}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"===typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.d(t,{Z:function(){return i}})},1367:function(e,t,r){r.d(t,{u:function(){return i}});var n=r(2212);class i extends n.Loader{constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}load(e,t,r,i){const o=this,s=new n.FileLoader(o.manager);s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(e,(function(r){try{t(o.parse(r))}catch(n){i?i(n):console.error(n),o.manager.itemError(e)}}),r,i)}parse(e){const t=this;function r(e,t,r,n,o,s,a,u){if(0==t||0==r)return void e.lineTo(u.x,u.y);n=n*Math.PI/180,t=Math.abs(t),r=Math.abs(r);const l=(a.x-u.x)/2,c=(a.y-u.y)/2,p=Math.cos(n)*l+Math.sin(n)*c,m=-Math.sin(n)*l+Math.cos(n)*c;let h=t*t,f=r*r;const _=p*p,d=m*m,x=_/h+d/f;if(x>1){const e=Math.sqrt(x);h=(t*=e)*t,f=(r*=e)*r}const y=h*d+f*_,v=(h*f-y)/y;let g=Math.sqrt(Math.max(0,v));o===s&&(g=-g);const b=g*t*m/r,w=-g*r*p/t,M=Math.cos(n)*b-Math.sin(n)*w+(a.x+u.x)/2,S=Math.sin(n)*b+Math.cos(n)*w+(a.y+u.y)/2,T=i(1,0,(p-b)/t,(m-w)/r),C=i((p-b)/t,(m-w)/r,(-p-b)/t,(-m-w)/r)%(2*Math.PI);e.currentPath.absellipse(M,S,t,r,T,T+C,0===s,n)}function i(e,t,r,n){const i=e*r+t*n,o=Math.sqrt(e*e+t*t)*Math.sqrt(r*r+n*n);let s=Math.acos(Math.max(-1,Math.min(1,i/o)));return e*n-t*r<0&&(s=-s),s}function o(e,t){t=Object.assign({},t);let r={};if(e.hasAttribute("class")){const t=e.getAttribute("class").split(/\s/).filter(Boolean).map((e=>e.trim()));for(let e=0;e<t.length;e++)r=Object.assign(r,f["."+t[e]])}function n(n,i,o){void 0===o&&(o=function(e){return e.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),e}),e.hasAttribute(n)&&(t[i]=o(e.getAttribute(n))),r[n]&&(t[i]=o(r[n])),e.style&&""!==e.style[n]&&(t[i]=o(e.style[n]))}function i(e){return Math.max(0,Math.min(1,c(e)))}function o(e){return Math.max(0,c(e))}return e.hasAttribute("id")&&(r=Object.assign(r,f["#"+e.getAttribute("id")])),n("fill","fill"),n("fill-opacity","fillOpacity",i),n("fill-rule","fillRule"),n("opacity","opacity",i),n("stroke","stroke"),n("stroke-opacity","strokeOpacity",i),n("stroke-width","strokeWidth",o),n("stroke-linejoin","strokeLineJoin"),n("stroke-linecap","strokeLineCap"),n("stroke-miterlimit","strokeMiterLimit",o),n("visibility","visibility"),t}function s(e,t){return e-(t-e)}function a(e,t,r){if("string"!==typeof e)throw new TypeError("Invalid input: "+typeof e);const n={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/};let i=0,o=!0,s="",a="";const u=[];function l(e,t,r){const n=new SyntaxError('Unexpected character "'+e+'" at index '+t+".");throw n.partial=r,n}function c(){""!==s&&(""===a?u.push(Number(s)):u.push(Number(s)*Math.pow(10,Number(a)))),s="",a=""}let p;const m=e.length;for(let h=0;h<m;h++)if(p=e[h],Array.isArray(t)&&t.includes(u.length%r)&&n.FLAGS.test(p))i=1,s=p,c();else{if(0===i){if(n.WHITESPACE.test(p))continue;if(n.DIGIT.test(p)||n.SIGN.test(p)){i=1,s=p;continue}if(n.POINT.test(p)){i=2,s=p;continue}n.COMMA.test(p)&&(o&&l(p,h,u),o=!0)}if(1===i){if(n.DIGIT.test(p)){s+=p;continue}if(n.POINT.test(p)){s+=p,i=2;continue}if(n.EXP.test(p)){i=3;continue}n.SIGN.test(p)&&1===s.length&&n.SIGN.test(s[0])&&l(p,h,u)}if(2===i){if(n.DIGIT.test(p)){s+=p;continue}if(n.EXP.test(p)){i=3;continue}n.POINT.test(p)&&"."===s[s.length-1]&&l(p,h,u)}if(3===i){if(n.DIGIT.test(p)){a+=p;continue}if(n.SIGN.test(p)){if(""===a){a+=p;continue}1===a.length&&n.SIGN.test(a)&&l(p,h,u)}}n.WHITESPACE.test(p)?(c(),i=0,o=!1):n.COMMA.test(p)?(c(),i=0,o=!0):n.SIGN.test(p)?(c(),i=1,s=p):n.POINT.test(p)?(c(),i=2,s=p):l(p,h,u)}return c(),u}const u=["mm","cm","in","pt","pc","px"],l={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function c(e){let r,n="px";if("string"===typeof e||e instanceof String)for(let t=0,i=u.length;t<i;t++){const r=u[t];if(e.endsWith(r)){n=r,e=e.substring(0,e.length-r.length);break}}return"px"===n&&"px"!==t.defaultUnit?r=l.in[t.defaultUnit]/t.defaultDPI:(r=l[n][t.defaultUnit],r<0&&(r=l[n].in*t.defaultDPI)),r*parseFloat(e)}function p(e){const t=e.elements;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function m(e){const t=e.elements;return Math.sqrt(t[3]*t[3]+t[4]*t[4])}const h=[],f={},_=[],d=new n.Matrix3,x=new n.Matrix3,y=new n.Matrix3,v=new n.Matrix3,g=new n.Vector2,b=new n.Vector3,w=new n.Matrix3,M=(new DOMParser).parseFromString(e,"image/svg+xml");!function e(t,i){if(1!==t.nodeType)return;const u=function(e){if(!(e.hasAttribute("transform")||"use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))))return null;const t=function(e){const t=new n.Matrix3,r=d;if("use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))){const r=c(e.getAttribute("x")),n=c(e.getAttribute("y"));t.translate(r,n)}if(e.hasAttribute("transform")){const n=e.getAttribute("transform").split(")");for(let e=n.length-1;e>=0;e--){const i=n[e].trim();if(""===i)continue;const o=i.indexOf("("),s=i.length;if(o>0&&o<s){const e=i.substr(0,o),t=a(i.substr(o+1,s-o-1));switch(r.identity(),e){case"translate":if(t.length>=1){const e=t[0];let n=e;t.length>=2&&(n=t[1]),r.translate(e,n)}break;case"rotate":if(t.length>=1){let e=0,n=0,i=0;e=-t[0]*Math.PI/180,t.length>=3&&(n=t[1],i=t[2]),x.identity().translate(-n,-i),y.identity().rotate(e),v.multiplyMatrices(y,x),x.identity().translate(n,i),r.multiplyMatrices(x,v)}break;case"scale":if(t.length>=1){const e=t[0];let n=e;t.length>=2&&(n=t[1]),r.scale(e,n)}break;case"skewX":1===t.length&&r.set(1,Math.tan(t[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===t.length&&r.set(1,0,0,Math.tan(t[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===t.length&&r.set(t[0],t[2],t[4],t[1],t[3],t[5],0,0,1)}}t.premultiply(r)}}return t}(e);_.length>0&&t.premultiply(_[_.length-1]);return w.copy(t),_.push(t),t}(t);let l=!0,M=null;switch(t.nodeName){case"svg":break;case"style":!function(e){if(!e.sheet||!e.sheet.cssRules||!e.sheet.cssRules.length)return;for(let t=0;t<e.sheet.cssRules.length;t++){const r=e.sheet.cssRules[t];if(1!==r.type)continue;const n=r.selectorText.split(/,/gm).filter(Boolean).map((e=>e.trim()));for(let e=0;e<n.length;e++)f[n[e]]=Object.assign(f[n[e]]||{},r.style)}}(t);break;case"g":i=o(t,i);break;case"path":i=o(t,i),t.hasAttribute("d")&&(M=function(e){const t=new n.ShapePath,i=new n.Vector2,o=new n.Vector2,u=new n.Vector2;let l=!0,c=!1;const p=e.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi);for(let n=0,m=p.length;n<m;n++){const e=p[n],m=e.charAt(0),h=e.substr(1).trim();let f;switch(!0===l&&(c=!0,l=!1),m){case"M":f=a(h);for(let e=0,r=f.length;e<r;e+=2)i.x=f[e+0],i.y=f[e+1],o.x=i.x,o.y=i.y,0===e?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y),0===e&&!0===c&&u.copy(i);break;case"H":f=a(h);for(let e=0,r=f.length;e<r;e++)i.x=f[e],o.x=i.x,o.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&u.copy(i);break;case"V":f=a(h);for(let e=0,r=f.length;e<r;e++)i.y=f[e],o.x=i.x,o.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&u.copy(i);break;case"L":f=a(h);for(let e=0,r=f.length;e<r;e+=2)i.x=f[e+0],i.y=f[e+1],o.x=i.x,o.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&u.copy(i);break;case"C":f=a(h);for(let e=0,r=f.length;e<r;e+=6)t.bezierCurveTo(f[e+0],f[e+1],f[e+2],f[e+3],f[e+4],f[e+5]),o.x=f[e+2],o.y=f[e+3],i.x=f[e+4],i.y=f[e+5],0===e&&!0===c&&u.copy(i);break;case"S":f=a(h);for(let e=0,r=f.length;e<r;e+=4)t.bezierCurveTo(s(i.x,o.x),s(i.y,o.y),f[e+0],f[e+1],f[e+2],f[e+3]),o.x=f[e+0],o.y=f[e+1],i.x=f[e+2],i.y=f[e+3],0===e&&!0===c&&u.copy(i);break;case"Q":f=a(h);for(let e=0,r=f.length;e<r;e+=4)t.quadraticCurveTo(f[e+0],f[e+1],f[e+2],f[e+3]),o.x=f[e+0],o.y=f[e+1],i.x=f[e+2],i.y=f[e+3],0===e&&!0===c&&u.copy(i);break;case"T":f=a(h);for(let e=0,r=f.length;e<r;e+=2){const r=s(i.x,o.x),n=s(i.y,o.y);t.quadraticCurveTo(r,n,f[e+0],f[e+1]),o.x=r,o.y=n,i.x=f[e+0],i.y=f[e+1],0===e&&!0===c&&u.copy(i)}break;case"A":f=a(h,[3,4],7);for(let e=0,n=f.length;e<n;e+=7){if(f[e+5]==i.x&&f[e+6]==i.y)continue;const n=i.clone();i.x=f[e+5],i.y=f[e+6],o.x=i.x,o.y=i.y,r(t,f[e],f[e+1],f[e+2],f[e+3],f[e+4],n,i),0===e&&!0===c&&u.copy(i)}break;case"m":f=a(h);for(let e=0,r=f.length;e<r;e+=2)i.x+=f[e+0],i.y+=f[e+1],o.x=i.x,o.y=i.y,0===e?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y),0===e&&!0===c&&u.copy(i);break;case"h":f=a(h);for(let e=0,r=f.length;e<r;e++)i.x+=f[e],o.x=i.x,o.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&u.copy(i);break;case"v":f=a(h);for(let e=0,r=f.length;e<r;e++)i.y+=f[e],o.x=i.x,o.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&u.copy(i);break;case"l":f=a(h);for(let e=0,r=f.length;e<r;e+=2)i.x+=f[e+0],i.y+=f[e+1],o.x=i.x,o.y=i.y,t.lineTo(i.x,i.y),0===e&&!0===c&&u.copy(i);break;case"c":f=a(h);for(let e=0,r=f.length;e<r;e+=6)t.bezierCurveTo(i.x+f[e+0],i.y+f[e+1],i.x+f[e+2],i.y+f[e+3],i.x+f[e+4],i.y+f[e+5]),o.x=i.x+f[e+2],o.y=i.y+f[e+3],i.x+=f[e+4],i.y+=f[e+5],0===e&&!0===c&&u.copy(i);break;case"s":f=a(h);for(let e=0,r=f.length;e<r;e+=4)t.bezierCurveTo(s(i.x,o.x),s(i.y,o.y),i.x+f[e+0],i.y+f[e+1],i.x+f[e+2],i.y+f[e+3]),o.x=i.x+f[e+0],o.y=i.y+f[e+1],i.x+=f[e+2],i.y+=f[e+3],0===e&&!0===c&&u.copy(i);break;case"q":f=a(h);for(let e=0,r=f.length;e<r;e+=4)t.quadraticCurveTo(i.x+f[e+0],i.y+f[e+1],i.x+f[e+2],i.y+f[e+3]),o.x=i.x+f[e+0],o.y=i.y+f[e+1],i.x+=f[e+2],i.y+=f[e+3],0===e&&!0===c&&u.copy(i);break;case"t":f=a(h);for(let e=0,r=f.length;e<r;e+=2){const r=s(i.x,o.x),n=s(i.y,o.y);t.quadraticCurveTo(r,n,i.x+f[e+0],i.y+f[e+1]),o.x=r,o.y=n,i.x=i.x+f[e+0],i.y=i.y+f[e+1],0===e&&!0===c&&u.copy(i)}break;case"a":f=a(h,[3,4],7);for(let e=0,n=f.length;e<n;e+=7){if(0==f[e+5]&&0==f[e+6])continue;const n=i.clone();i.x+=f[e+5],i.y+=f[e+6],o.x=i.x,o.y=i.y,r(t,f[e],f[e+1],f[e+2],f[e+3],f[e+4],n,i),0===e&&!0===c&&u.copy(i)}break;case"Z":case"z":t.currentPath.autoClose=!0,t.currentPath.curves.length>0&&(i.copy(u),t.currentPath.currentPoint.copy(i),l=!0);break;default:console.warn(e)}c=!1}return t}(t));break;case"rect":i=o(t,i),M=function(e){const t=c(e.getAttribute("x")||0),r=c(e.getAttribute("y")||0),i=c(e.getAttribute("rx")||e.getAttribute("ry")||0),o=c(e.getAttribute("ry")||e.getAttribute("rx")||0),s=c(e.getAttribute("width")),a=c(e.getAttribute("height")),u=.448084975506,l=new n.ShapePath;l.moveTo(t+i,r),l.lineTo(t+s-i,r),(0!==i||0!==o)&&l.bezierCurveTo(t+s-i*u,r,t+s,r+o*u,t+s,r+o);l.lineTo(t+s,r+a-o),(0!==i||0!==o)&&l.bezierCurveTo(t+s,r+a-o*u,t+s-i*u,r+a,t+s-i,r+a);l.lineTo(t+i,r+a),(0!==i||0!==o)&&l.bezierCurveTo(t+i*u,r+a,t,r+a-o*u,t,r+a-o);l.lineTo(t,r+o),(0!==i||0!==o)&&l.bezierCurveTo(t,r+o*u,t+i*u,r,t+i,r);return l}(t);break;case"polygon":i=o(t,i),M=function(e){function t(e,t,r){const n=c(t),s=c(r);0===o?i.moveTo(n,s):i.lineTo(n,s),o++}const r=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,i=new n.ShapePath;let o=0;return e.getAttribute("points").replace(r,t),i.currentPath.autoClose=!0,i}(t);break;case"polyline":i=o(t,i),M=function(e){function t(e,t,r){const n=c(t),s=c(r);0===o?i.moveTo(n,s):i.lineTo(n,s),o++}const r=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,i=new n.ShapePath;let o=0;return e.getAttribute("points").replace(r,t),i.currentPath.autoClose=!1,i}(t);break;case"circle":i=o(t,i),M=function(e){const t=c(e.getAttribute("cx")||0),r=c(e.getAttribute("cy")||0),i=c(e.getAttribute("r")||0),o=new n.Path;o.absarc(t,r,i,0,2*Math.PI);const s=new n.ShapePath;return s.subPaths.push(o),s}(t);break;case"ellipse":i=o(t,i),M=function(e){const t=c(e.getAttribute("cx")||0),r=c(e.getAttribute("cy")||0),i=c(e.getAttribute("rx")||0),o=c(e.getAttribute("ry")||0),s=new n.Path;s.absellipse(t,r,i,o,0,2*Math.PI);const a=new n.ShapePath;return a.subPaths.push(s),a}(t);break;case"line":i=o(t,i),M=function(e){const t=c(e.getAttribute("x1")||0),r=c(e.getAttribute("y1")||0),i=c(e.getAttribute("x2")||0),o=c(e.getAttribute("y2")||0),s=new n.ShapePath;return s.moveTo(t,r),s.lineTo(i,o),s.currentPath.autoClose=!1,s}(t);break;case"defs":l=!1;break;case"use":i=o(t,i);const u=t.href.baseVal.substring(1),p=t.viewportElement.getElementById(u);p?e(p,i):console.warn("SVGLoader: 'use node' references non-existent node id: "+u)}if(M&&(void 0!==i.fill&&"none"!==i.fill&&M.color.setStyle(i.fill),function(e,t){function r(e){b.set(e.x,e.y,1).applyMatrix3(t),e.set(b.x,b.y)}const n=function(e){return 0!==e.elements[1]||0!==e.elements[3]}(t),i=e.subPaths;for(let o=0,s=i.length;o<s;o++){const e=i[o].curves;for(let i=0;i<e.length;i++){const o=e[i];o.isLineCurve?(r(o.v1),r(o.v2)):o.isCubicBezierCurve?(r(o.v0),r(o.v1),r(o.v2),r(o.v3)):o.isQuadraticBezierCurve?(r(o.v0),r(o.v1),r(o.v2)):o.isEllipseCurve&&(n&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),g.set(o.aX,o.aY),r(g),o.aX=g.x,o.aY=g.y,o.xRadius*=p(t),o.yRadius*=m(t))}}}(M,w),h.push(M),M.userData={node:t,style:i}),l){const r=t.childNodes;for(let t=0;t<r.length;t++)e(r[t],i)}u&&(_.pop(),_.length>0?w.copy(_[_.length-1]):w.identity())}(M.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4});return{paths:h,xml:M.documentElement}}static createShapes(e){const t=999999999,r=0,i=1,o=2,s=3,a=4,u=5,l=6,c={loc:r,t:0};function p(e,t,n,i){const s=e.x,a=t.x,u=n.x,l=i.x,p=e.y,h=t.y,f=n.y,_=i.y,d=(l-u)*(p-f)-(_-f)*(s-u),x=(_-f)*(a-s)-(l-u)*(h-p),y=d/x,v=((a-s)*(p-f)-(h-p)*(s-u))/x;if(0===x&&0!==d||y<=0||y>=1||v<0||v>1)return null;if(0===d&&0===x){for(let u=0;u<2;u++){if(m(0===u?n:i,e,t),c.loc==r){const e=0===u?n:i;return{x:e.x,y:e.y,t:c.t}}if(c.loc==o){return{x:+(s+c.t*(a-s)).toPrecision(10),y:+(p+c.t*(h-p)).toPrecision(10),t:c.t}}}return null}for(let o=0;o<2;o++)if(m(0===o?n:i,e,t),c.loc==r){const e=0===o?n:i;return{x:e.x,y:e.y,t:c.t}}return{x:+(s+y*(a-s)).toPrecision(10),y:+(p+y*(h-p)).toPrecision(10),t:y}}function m(e,t,n){const p=n.x-t.x,m=n.y-t.y,h=e.x-t.x,f=e.y-t.y,_=p*f-h*m;if(e.x===t.x&&e.y===t.y)return c.loc=r,void(c.t=0);if(e.x===n.x&&e.y===n.y)return c.loc=i,void(c.t=1);if(_<-Number.EPSILON)return void(c.loc=s);if(_>Number.EPSILON)return void(c.loc=a);if(p*h<0||m*f<0)return void(c.loc=u);if(Math.sqrt(p*p+m*m)<Math.sqrt(h*h+f*f))return void(c.loc=l);let d;d=0!==p?h/p:f/m,c.loc=o,c.t=d}function h(e,t,r){const i=new n.Vector2;t.getCenter(i);const o=[];return r.forEach((t=>{if(t.boundingBox.containsPoint(i)){(function(e,t){const r=[],i=[];for(let o=1;o<e.length;o++){const s=e[o-1],a=e[o];for(let e=1;e<t.length;e++){const o=p(s,a,t[e-1],t[e]);null!==o&&void 0===r.find((e=>e.t<=o.t+Number.EPSILON&&e.t>=o.t-Number.EPSILON))&&(r.push(o),i.push(new n.Vector2(o.x,o.y)))}}return i})(e,t.points).forEach((e=>{o.push({identifier:t.identifier,isCW:t.isCW,point:e})}))}})),o.sort(((e,t)=>e.point.x-t.point.x)),o}let f=0,_=t,d=-999999999,x=e.subPaths.map((e=>{const r=e.getPoints();let i=-999999999,o=t,s=-999999999,a=t;for(let t=0;t<r.length;t++){const e=r[t];e.y>i&&(i=e.y),e.y<o&&(o=e.y),e.x>s&&(s=e.x),e.x<a&&(a=e.x)}return d<=s&&(d=s+1),_>=a&&(_=a-1),{curves:e.curves,points:r,isCW:n.ShapeUtils.isClockWise(r),identifier:f++,boundingBox:new n.Box2(new n.Vector2(a,o),new n.Vector2(s,i))}}));x=x.filter((e=>e.points.length>1));const y=x.map((t=>function(e,t,r,i,o){null!==o&&void 0!==o&&""!==o||(o="nonzero");const s=new n.Vector2;e.boundingBox.getCenter(s);const a=h([new n.Vector2(r,s.y),new n.Vector2(i,s.y)],e.boundingBox,t);a.sort(((e,t)=>e.point.x-t.point.x));const u=[],l=[];a.forEach((t=>{t.identifier===e.identifier?u.push(t):l.push(t)}));const c=u[0].point.x,p=[];let m=0;for(;m<l.length&&l[m].point.x<c;)p.length>0&&p[p.length-1]===l[m].identifier?p.pop():p.push(l[m].identifier),m++;if(p.push(e.identifier),"evenodd"===o){const t=p.length%2===0,r=p[p.length-2];return{identifier:e.identifier,isHole:t,for:r}}if("nonzero"===o){let r=!0,n=null,i=null;for(let e=0;e<p.length;e++){const o=p[e];r?(i=t[o].isCW,r=!1,n=o):i!==t[o].isCW&&(i=t[o].isCW,r=!0)}return{identifier:e.identifier,isHole:r,for:n}}console.warn('fill-rule: "'+o+'" is currently not implemented.')}(t,x,_,d,e.userData.style.fillRule))),v=[];return x.forEach((e=>{if(!y[e.identifier].isHole){const t=new n.Shape;t.curves=e.curves;y.filter((t=>t.isHole&&t.for===e.identifier)).forEach((e=>{const r=x[e.identifier],i=new n.Path;i.curves=r.curves,t.holes.push(i)})),v.push(t)}})),v}static getStrokeStyle(e,t,r,n,i){return{strokeColor:t=void 0!==t?t:"#000",strokeWidth:e=void 0!==e?e:1,strokeLineJoin:r=void 0!==r?r:"miter",strokeLineCap:n=void 0!==n?n:"butt",strokeMiterLimit:i=void 0!==i?i:4}}static pointsToStroke(e,t,r,o){const s=[],a=[],u=[];if(0===i.pointsToStrokeWithBuffers(e,t,r,o,s,a,u))return null;const l=new n.BufferGeometry;return l.setAttribute("position",new n.Float32BufferAttribute(s,3)),l.setAttribute("normal",new n.Float32BufferAttribute(a,3)),l.setAttribute("uv",new n.Float32BufferAttribute(u,2)),l}static pointsToStrokeWithBuffers(e,t,r,i,o,s,a,u){const l=new n.Vector2,c=new n.Vector2,p=new n.Vector2,m=new n.Vector2,h=new n.Vector2,f=new n.Vector2,_=new n.Vector2,d=new n.Vector2,x=new n.Vector2,y=new n.Vector2,v=new n.Vector2,g=new n.Vector2,b=new n.Vector2,w=new n.Vector2,M=new n.Vector2,S=new n.Vector2,T=new n.Vector2;r=void 0!==r?r:12,i=void 0!==i?i:.001,u=void 0!==u?u:0;const C=(e=function(e){let t=!1;for(let n=1,o=e.length-1;n<o;n++)if(e[n].distanceTo(e[n+1])<i){t=!0;break}if(!t)return e;const r=[];r.push(e[0]);for(let n=1,o=e.length-1;n<o;n++)e[n].distanceTo(e[n+1])>=i&&r.push(e[n]);return r.push(e[e.length-1]),r}(e)).length;if(C<2)return 0;const A=e[0].equals(e[C-1]);let E,k,D=e[0];const B=t.strokeWidth/2,P=1/(C-1);let R,V,L,I,j=0,U=!1,O=0,z=3*u,F=2*u;N(e[0],e[1],l).multiplyScalar(B),d.copy(e[0]).sub(l),x.copy(e[0]).add(l),y.copy(d),v.copy(x);for(let n=1;n<C;n++){E=e[n],k=n===C-1?A?e[1]:void 0:e[n+1];const r=l;if(N(D,E,r),p.copy(r).multiplyScalar(B),g.copy(E).sub(p),b.copy(E).add(p),R=j+P,V=!1,void 0!==k){N(E,k,c),p.copy(c).multiplyScalar(B),w.copy(E).sub(p),M.copy(E).add(p),L=!0,p.subVectors(k,D),r.dot(p)<0&&(L=!1),1===n&&(U=L),p.subVectors(k,E),p.normalize();const e=Math.abs(r.dot(p));if(0!==e){const r=B/e;p.multiplyScalar(-r),m.subVectors(E,D),h.copy(m).setLength(r).add(p),S.copy(h).negate();const n=h.length(),i=m.length();m.divideScalar(i),f.subVectors(k,E);const o=f.length();switch(f.divideScalar(o),m.dot(S)<i&&f.dot(S)<o&&(V=!0),T.copy(h).add(E),S.add(E),I=!1,V?L?(M.copy(S),b.copy(S)):(w.copy(S),g.copy(S)):q(),t.strokeLineJoin){case"bevel":H(L,V,R);break;case"round":Y(L,V),L?W(E,g,w,R,0):W(E,M,b,R,1);break;case"miter":case"miter-clip":default:const e=B*t.strokeMiterLimit/n;if(e<1){if("miter-clip"!==t.strokeLineJoin){H(L,V,R);break}Y(L,V),L?(f.subVectors(T,g).multiplyScalar(e).add(g),_.subVectors(T,w).multiplyScalar(e).add(w),G(g,R,0),G(f,R,0),G(E,R,.5),G(E,R,.5),G(f,R,0),G(_,R,0),G(E,R,.5),G(_,R,0),G(w,R,0)):(f.subVectors(T,b).multiplyScalar(e).add(b),_.subVectors(T,M).multiplyScalar(e).add(M),G(b,R,1),G(f,R,1),G(E,R,.5),G(E,R,.5),G(f,R,1),G(_,R,1),G(E,R,.5),G(_,R,1),G(M,R,1))}else V?(L?(G(x,j,1),G(d,j,0),G(T,R,0),G(x,j,1),G(T,R,0),G(S,R,1)):(G(x,j,1),G(d,j,0),G(T,R,1),G(d,j,0),G(S,R,0),G(T,R,1)),L?w.copy(T):M.copy(T)):L?(G(g,R,0),G(T,R,0),G(E,R,.5),G(E,R,.5),G(T,R,0),G(w,R,0)):(G(b,R,1),G(T,R,1),G(E,R,.5),G(E,R,.5),G(T,R,1),G(M,R,1)),I=!0}}else q()}else q();A||n!==C-1||Z(e[0],y,v,L,!0,j),j=R,D=E,d.copy(w),x.copy(M)}if(A){if(V&&o){let e=T,t=S;U!==L&&(e=S,t=T),L?(I||U)&&(t.toArray(o,0),t.toArray(o,9),I&&e.toArray(o,3)):!I&&U||(t.toArray(o,3),t.toArray(o,9),I&&e.toArray(o,0))}}else Z(E,g,b,L,!1,R);return O;function N(e,t,r){return r.subVectors(t,e),r.set(-r.y,r.x).normalize()}function G(e,t,r){o&&(o[z]=e.x,o[z+1]=e.y,o[z+2]=0,s&&(s[z]=0,s[z+1]=0,s[z+2]=1),z+=3,a&&(a[F]=t,a[F+1]=r,F+=2)),O+=3}function W(e,t,n,i,o){l.copy(t).sub(e).normalize(),c.copy(n).sub(e).normalize();let s=Math.PI;const a=l.dot(c);Math.abs(a)<1&&(s=Math.abs(Math.acos(a))),s/=r,p.copy(t);for(let u=0,l=r-1;u<l;u++)m.copy(p).rotateAround(e,s),G(p,i,o),G(m,i,o),G(e,i,.5),p.copy(m);G(m,i,o),G(n,i,o),G(e,i,.5)}function q(){G(x,j,1),G(d,j,0),G(g,R,0),G(x,j,1),G(g,R,1),G(b,R,0)}function H(e,t,r){t?e?(G(x,j,1),G(d,j,0),G(g,R,0),G(x,j,1),G(g,R,0),G(S,R,1),G(g,r,0),G(w,r,0),G(S,r,.5)):(G(x,j,1),G(d,j,0),G(b,R,1),G(d,j,0),G(S,R,0),G(b,R,1),G(b,r,1),G(M,r,0),G(S,r,.5)):e?(G(g,r,0),G(w,r,0),G(E,r,.5)):(G(b,r,1),G(M,r,0),G(E,r,.5))}function Y(e,t){t&&(e?(G(x,j,1),G(d,j,0),G(g,R,0),G(x,j,1),G(g,R,0),G(S,R,1),G(g,j,0),G(E,R,.5),G(S,R,1),G(E,R,.5),G(w,j,0),G(S,R,1)):(G(x,j,1),G(d,j,0),G(b,R,1),G(d,j,0),G(S,R,0),G(b,R,1),G(b,j,1),G(S,R,0),G(E,R,.5),G(E,R,.5),G(S,R,0),G(M,j,1)))}function Z(e,r,n,i,s,a){switch(t.strokeLineCap){case"round":s?W(e,n,r,a,.5):W(e,r,n,a,.5);break;case"square":if(s)l.subVectors(r,e),c.set(l.y,-l.x),p.addVectors(l,c).add(e),m.subVectors(c,l).add(e),i?(p.toArray(o,3),m.toArray(o,0),m.toArray(o,9)):(p.toArray(o,3),p.toArray(o,9),m.toArray(o,0));else{l.subVectors(n,e),c.set(l.y,-l.x),p.addVectors(l,c).add(e),m.subVectors(c,l).add(e);const t=o.length;i?(p.toArray(o,t-3),m.toArray(o,t-6),m.toArray(o,t-12)):(p.toArray(o,t-6),m.toArray(o,t-3),m.toArray(o,t-12))}}}}}}}]);